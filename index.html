<!-- index.html -->
<!doctype html>
<html lang="ar">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Fsh5Flix — الصفحة الرئيسية</title>
  <link href="https://vjs.zencdn.net/8.20.0/video-js.css" rel="stylesheet" />
  <style>
    :root{--bg:#030712;--card:#071826;--accent:#e50914;--muted:rgba(255,255,255,0.6);--glass:rgba(255,255,255,0.03)}
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:radial-gradient(1200px 400px at 10% 10%,rgba(229,9,20,0.06),transparent),linear-gradient(180deg,#00121a,#02141a 60%,var(--bg));color:#eaf6ff;font-family:Inter,system-ui,Arial}
    header{display:flex;align-items:center;justify-content:space-between;padding:18px 36px;border-bottom:1px solid rgba(255,255,255,0.03)}
    .brand{display:flex;align-items:center;gap:14px}
    .logo{font-weight:900;font-size:22px;color:var(--accent);letter-spacing:0.6px}
    .subtitle{color:var(--muted);font-size:13px}
    main{padding:26px 36px}
    .section{margin-bottom:34px}
    .section h2{margin:0 0 12px 0;font-size:20px}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:18px}
    .card{background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);border-radius:12px;overflow:hidden;cursor:pointer;transform:translateY(20px);opacity:0;animation:cardIn .6s forwards;transition:transform .28s cubic-bezier(.2,.9,.3,1),box-shadow .28s}
    .card:nth-child(1){animation-delay:.06s}.card:nth-child(2){animation-delay:.12s}.card:nth-child(3){animation-delay:.18s}
    .thumb{height:320px;background:#071826;display:flex;align-items:end;padding:12px;position:relative}
    .thumb img{width:100%;height:100%;object-fit:cover;border-radius:8px}
    .overlay-gradient{position:absolute;left:0;right:0;bottom:0;height:46%;background:linear-gradient(0deg,rgba(0,0,0,0.7),transparent)}
    .title{padding:10px 12px;font-weight:800;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .meta{padding:0 12px 14px 12px;color:var(--muted);font-size:13px}
    .card:hover{transform:translateY(-12px) scale(1.06);box-shadow:0 24px 60px rgba(2,8,20,0.6)}
    @keyframes cardIn{from{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}
    footer{padding:20px 36px;color:rgba(255,255,255,0.42);text-align:center}
    @media (max-width:900px){.thumb{height:220px}.grid{grid-template-columns:repeat(auto-fill,minmax(150px,1fr))}}
  </style>
</head>
<body>
  <header>
    <div class="brand"><div class="logo">Fsh5Flix</div><div class="subtitle">المسلسلات والأفلام</div></div>
    <div style="min-width:120px;text-align:right;color:rgba(255,255,255,0.7)">مخزن: PixelDrain</div>
  </header>

  <main>
    <section class="section">
      <h2>المتاح الآن</h2>
      <div class="grid" id="catalog"></div>
    </section>
  </main>

  <footer>صُنع بحب — اضغط على أي بوستر لفتح المشغل</footer>

  <script>
    // بدون بحث — العرض فقط
    const JSON_URL = '/playlist.json';
    const catalog = document.getElementById('catalog');

    async function loadCatalog(){
      try{
        const res = await fetch(JSON_URL);
        if(!res.ok) throw new Error('فشل تحميل JSON');
        const data = await res.json();
        renderCatalog(data);
      }catch(err){
        catalog.innerHTML = `<div style="padding:30px;color:#f88">حصل خطأ في تحميل الـ JSON: ${err.message}. تأكد من مسار playlist.json</div>`;
        console.error(err);
      }
    }

    function renderCatalog(data){
      catalog.innerHTML = '';
      Object.keys(data).forEach(title=>{
        const items = data[title];
        const card = document.createElement('div'); card.className='card';
        const thumb = document.createElement('div'); thumb.className='thumb';

        const poster = (items[0] && items[0].poster) ? items[0].poster : '';
        if(poster){
          const img = document.createElement('img'); img.src = poster; img.alt = title; thumb.appendChild(img);
        } else {
          const p = document.createElement('div'); p.style.padding='18px'; p.innerHTML = `<div style="font-size:18px;font-weight:800">${title}</div>`; thumb.appendChild(p);
        }
        const grad = document.createElement('div'); grad.className='overlay-gradient'; thumb.appendChild(grad);

        const ttl = document.createElement('div'); ttl.className='title'; ttl.textContent = title;
        const meta = document.createElement('div'); meta.className='meta'; meta.textContent = items.length>1?`${items.length} حلقات`:'فيلم';

        card.appendChild(thumb); card.appendChild(ttl); card.appendChild(meta);

        // افتح player.html صفحة مستقلة — نمرر العنوان و idx أولي
        card.addEventListener('click', ()=>{
          const url = new URL(window.location.origin + '/player.html');
          url.searchParams.set('title', title);
          url.searchParams.set('idx','0');
          window.location.href = url.toString();
        });

        catalog.appendChild(card);
      });
    }

    loadCatalog();
  </script>
</body>
</html>